---
title: "hw5"
author: "marina"
date: '17 марта 2019 г '
output: html_document
---


##Задание

Задайте произвольным образом математическое ожидание a0 и среднеквадратическое отклонение σ0 нормального распределения, задайте вероятность ошибки первого рода $α$ и вероятность ошибки второго рода $β$, задайте значение $a1: a1<a0$. (пп 1-3 повторение задачи 9 ДЗ 4, пп 4-5 новые). Исправлены пункты 1-3, т.к в предыдущем семинаре были допущены ошибки.



```{r}
a0 = 1 
a1 = 0.5 
sd0 = 5 
alpha = 0.03 
betta = 0.03 

```

Найдите объем выборки n, при котором вероятности ошибок первого и второго рода при использовании критерия Неймана-Пирсона не превзойдут выбранных значений $α$ и $β$.

```{r}
n = floor(sd0*sd0 *(qnorm(1- alpha) - qnorm(betta)) ^ 2 /(a1 - a0) ^ 2) 
cat("n =", n) 
```
Оцените вероятность ошибки первого рода с помощью моделирования. Для этого смоделируйте выборку объема n из распределения $N(a0,σ0)$. Примените критерий для проверки гипотезы $H0:a=a0$ при альтернативе $H1:a=a1$, считая $σ0$ известным.

Оцените вероятность ошибки второго рода с помощью моделирования. Для этого смоделируйте выборку объема n из распределения $N(a1,σ0)$. Примените критерий для проверки гипотезы $H0:a=a0$ при альтернативе $H1:a=a1$, считая $σ0$ известным.

```{r}

  u = qnorm(alpha)
  resH = 0
  
  for (i in 1:1000) {
  sample = rnorm(n, a0, sd0)
  
  z = sqrt(n) * (mean(sample) - a0) / sd0
  
  if (z >= u) {
    resH = resH + 1
    }
}
cat("Оценка вероятности ошибки первого рода =", 1 - resH / 1000)


  u = qnorm(alpha)
  resH = 0
  
  for (i in 1:1000) {
  sample = rnorm(n, a1, sd0)
  
  z = sqrt(n) * (mean(sample) - a0) / sd0
  
  if (z >= u) {
    resH = resH + 1
    }
}
cat("\nОценка вероятности ошибки второго рода =", resH / 1000) 
```


Оцените средний объем, необходимый при применении последовательного критерия Вальда силы $(α',β')$ по выборке из генеральной совокупности $N(a0,σ0)$, используя приближенные границы, для проверки гипотезы $H0:a=a0$ при альтернативе $H1:a=a1$, считая $σ0$ известным.

```{r}
countSteps = c()
c0 = betta / (1 - alpha)
c1 = (1 - betta) / alpha

for(i in 1:1000) {
  n = 0
  flag_accept = F
  
  l0 = 0
  l1 = 0
  while(isFALSE(flag_accept)) {
    sample = rnorm(1, a0, sd0)
    l0 = l0 + log(dnorm(sample, a0, sd0))
    l1 = l1 + log(dnorm(sample, a1, sd0))
    
    if(l1 - l0 < log(c0) || l1 - l0 > log(c1)) {
      flag_accept = T
    }
    n = n + 1
  }
  
  countSteps[i] = n - 1
}
print(mean(countSteps))

```

Оцените средний объем, необходимый при применении последовательного критерия Вальда силы $(α',β')$  по выборке из генеральной совокупности $N(a1,σ0)$, используя приближенные границы, для проверки гипотезы  $H0:a=a0$ при альтернативе $H1:a=a1$, считая $σ0$ известным.
```{r}
countSteps = c()
c0 = betta / (1 - alpha)
c1 = (1 - betta) / alpha

for(i in 1:1000) {
  n = 0
  flag_accept = T
  
  l0 = 0
  l1 = 0
  while(!isFALSE(flag_accept)) {
    sample = rnorm(1, a0, sd0)
    l0 = l0 + log(dnorm(sample, a0, sd0))
    l1 = l1 + log(dnorm(sample, a1, sd0))
    
    if(l1 - l0 < log(c0) || l1 - l0 > log(c1)) {
      flag_accept = F
    }
    n = n + 1
  }
  
  countSteps[i] = n - 1
}
print(mean(countSteps))

```

####Выводы: 

* Критерий Вальда в обоих случаях требует выборки меньшего размера
* Для того, чтобы опровергнуть неверную гипотезу понадобился больший объем выборки, чем для того, чтобы принять истинную.
